<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Probability Treasure Adventure</title>
<style>
body { font-family: Arial, sans-serif; background: linear-gradient(to top, #87ceeb 0%, #fff 100%); text-align:center; margin:0; padding:0;}
.container { background:white; padding:20px; margin:20px auto; max-width:900px; border-radius:10px; box-shadow:0 0 15px rgba(0,0,0,0.3);}
button { padding:10px 20px; margin:5px; font-size:16px; border:none; border-radius:5px; cursor:pointer; background:#007bff; color:white;}
button:hover { background:#0056b3; }
#message { font-weight:bold; font-size:1.2em; min-height:30px; margin-top:10px;}
.progress-bar { width:80%; height:20px; background:#ddd; margin:10px auto; border-radius:10px; overflow:hidden; }
.progress-fill { height:100%; background:gold; width:0%; transition: width 0.5s; }
#shopItems div { display:inline-block; margin:5px; padding:5px; border:1px solid #ccc; border-radius:5px; width:100px; text-align:center;}
#drawer div { display:inline-block; margin:5px; padding:5px; border:1px solid #000; border-radius:5px; width:100px; text-align:center;}
</style>
</head>
<body>

<!-- Stage 1: Questions -->
<div class="container" id="stage1">
<h2>Stage 1: Treasure Adventure</h2>
<p>Coins: <span id="coins">0</span></p>
<p>Question: <span id="round">1</span>/5</p>
<p id="questionText"></p>
<div id="answerButtons"></div>
<p id="message"></p>
<div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
</div>

<!-- Stage 2: Shop -->
<div class="container" id="stage2" style="display:none;">
<h2>Stage 2: Treasure Shop</h2>
<p>Spend your coins to buy treasures:</p>
<p>Coins left: <span id="coinsLeft">0</span></p>
<div id="shopItems"></div>
<button onclick="finishStage2()">Open Drawer</button>
<p id="shopMsg"></p>
</div>

<!-- Stage 3: Drawer -->
<div class="container" id="stage3" style="display:none;">
<h2>Stage 3: Your Treasure Drawer</h2>
<div id="drawer"></div>
<p id="msg3"></p>
</div>

<script>
// ===== Stage 1 =====
let coins=0, questionIndex=0;
const totalQuestions=5;
const questions=[
  {q:"It's sunny. You want to go outside. What do you do?", options:["Wear sunglasses","Stay inside","Open umbrella"], answer:0, reward:4000},
  {q:"It's raining. What should you do?", options:["Take umbrella","Go swimming","Sunbathe"], answer:0, reward:4000},
  {q:"You roll a dice. What's the chance of getting 6?", options:["1/6","1/2","1/3"], answer:0, reward:4000},
  {q:"You see dark clouds. What is likely to happen?", options:["Rain","Snow","Sunny"], answer:0, reward:4000},
  {q:"You want to find treasure. Which is best?", options:["Look under rocks","Walk in sand","Fly a kite"], answer:0, reward:4000}
];

function showQuestion(){
  if(questionIndex>=totalQuestions){
    document.getElementById("stage1").style.display="none";
    if(coins>0){
      document.getElementById("stage2").style.display="block";
      startShop();
    } else {
      document.getElementById("message").innerText="ðŸ’¸ You didn't earn coins. Try again!";
      coins=0; questionIndex=0;
      setTimeout(showQuestion,2000);
    }
    return;
  }
  const q=questions[questionIndex];
  document.getElementById("round").innerText=questionIndex+1;
  document.getElementById("questionText").innerText=q.q;
  const btnDiv=document.getElementById("answerButtons");
  btnDiv.innerHTML="";
  q.options.forEach((opt,i)=>{
    const btn=document.createElement("button");
    btn.innerText=opt;
    btn.onclick=()=>checkAnswer(i);
    btnDiv.appendChild(btn);
  });
}

function checkAnswer(i){
  const q=questions[questionIndex];
  if(i===q.answer){
    coins+=q.reward;
    document.getElementById("message").innerText=`âœ… Correct! You earned â‚¹${q.reward}`;
  } else {
    document.getElementById("message").innerText="âŒ Wrong! No coins earned";
  }
  document.getElementById("coins").innerText=coins;
  document.getElementById("progress").style.width=`${Math.min(100,coins/20000*100)}%`;
  questionIndex++;
  setTimeout(showQuestion,1000);
}
showQuestion();

// ===== Stage 2: Shop =====
let purchasedItems=[];
const shopItemsData=[
  {name:"Gold Coin", cost:5000},
  {name:"Gem", cost:7000},
  {name:"Map", cost:4000},
  {name:"Treasure Chest", cost:8000}
];

function startShop(){
  purchasedItems=[];
  document.getElementById("coinsLeft").innerText=coins;
  const shopDiv=document.getElementById("shopItems");
  shopDiv.innerHTML="";
  shopItemsData.forEach((item,i)=>{
    const div=document.createElement("div");
    div.innerHTML=`${item.name}<br>â‚¹${item.cost}<br><button onclick="buyItem(${i})">Buy</button>`;
    shopDiv.appendChild(div);
  });
}

function buyItem(i){
  const item=shopItemsData[i];
  if(coins>=item.cost){
    coins-=item.cost;
    purchasedItems.push(item.name);
    document.getElementById("coinsLeft").innerText=coins;
    document.getElementById("shopMsg").innerText=`Bought ${item.name}!`;
  } else {
    document.getElementById("shopMsg").innerText="Not enough coins!";
  }
}

// ===== Stage 3: Drawer =====
function finishStage2(){
  document.getElementById("stage2").style.display="none";
  document.getElementById("stage3").style.display="block";
  const drawerDiv=document.getElementById("drawer");
  drawerDiv.innerHTML="";
  purchasedItems.forEach(it=>{
    const div=document.createElement("div");
    div.innerHTML=it;
    drawerDiv.appendChild(div);
  });
  document.getElementById("msg3").innerText="ðŸŽ‰ Your treasures are safely stored in the drawer!";
}
</script>
</body>
  </html>
